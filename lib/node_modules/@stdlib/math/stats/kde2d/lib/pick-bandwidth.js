'use strict';

// MODULES //
var stdev = require( './stdev.js' );
var range = require( './range.js' );
var iqr = require( './iqr.js' );

// MAIN //
/**
* Computes the rule-of-thumb bandwidth for given data
*
* @private
* @param {NumericArray} arr - input array
* @returns {number} bandwidth choice
*
* @example
* var arr = [ 2, 3, 4, 3, 5 ];
* var out = pickBandwidth( arr );
* // returns ~0.094809
*/

function pickBandwidth(data) {
	var frontConstant;
	var minElement;
	var sigmaHat;
	var bHat;
	var iqrVal;
	var n;

	// first get the constant terms
	sigmaHat = stdev(data);
	iqrVal = iqr(data);
	n = data.length;

	// frontConstant is all terms not in the min() call
	frontConstant = 1.06 * Math.pow(n, -1/5);

	// minElement is the elemtn that is in the min call
	minElement = Math.min(sigmaHat, iqrVal / 1.34);

	// bHat is the final answer
	bHat = frontConstant * minElement;
	return bHat;	
}

// EXPORTS // 

module.exports = pickBandwidth;

