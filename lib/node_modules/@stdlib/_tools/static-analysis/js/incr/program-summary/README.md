<!--

@license Apache-2.0

Copyright (c) 2018 The Stdlib Authors.

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

   http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.

-->

# Incremental Program Summary

> Generate an incremental program summary.

<!-- Section to include introductory text. Make sure to keep an empty line after the intro `section` element and another before the `/section` close. -->

<section class="intro">

</section>

<!-- /.intro -->

<!-- Package usage documentation. -->

<section class="usage">

## Usage

```javascript
var incrsummary = require( '@stdlib/_tools/static-analysis/js/incr/program-summary' );
```

#### incrsummary()

Returns an accumulator `function` for incrementally generating a program summary.

```javascript
var accumulator = incrsummary();
```

#### accumulator( \[input] )

If provided an input program, the accumulator function returns an updated summary. If not provided an input program, the accumulator function returns the current summary. The input program may be either a `string` or a [`Buffer`][@stdlib/buffer/ctor].

```javascript
var accumulator = incrsummary();

var summary = accumulator();
// returns {...}

summary = accumulator( 'var x = 5;' );
// returns {...}

summary = accumulator( 'var y = foo( 3.14 );' );
// returns {...}

summary = accumulator( 'if ( x < y ) {\n\tconsole.log( "x < y" );\n}\n' );
// returns {...}

summary = accumulator();
// returns {...}
```

</section>

<!-- /.usage -->

<!-- Package usage notes. Make sure to keep an empty line after the `section` element and another before the `/section` close. -->

<section class="notes">

## Notes

-   For each input program, the accumulator function generates a [program summary][@stdlib/_tools/static-analysis/js/program-summary] for that program. Upon generating a [program summary][@stdlib/_tools/static-analysis/js/program-summary], the accumulator extracts summary results and updates the accumulator state.

-   Beware when modifying the returned accumulator state. If corrupted, no guarantee is made that the accumulator will recover or produce accurate results.

-   If provided a malformed input program, the accumulator will throw an `Error`.

-   The accumulator tracks the following program metrics:

    -   **length**: program length.
    -   **whitespace**: program whitespace.
    -   **lines**: program lines.
    -   **empty**: program empty lines.
    -   **sloc**: program source lines of codes (SLOC).
    -   **lloc**: program logical lines of code (LLOC).
    -   **statements**: number of program statements.
    -   **branches**: number of program branches.
    -   **comments.count**: number of program comments.
    -   **comments.length**: total character length of program comments.
    -   **comments.whitespace**: amount of whitespace in program comments.
    -   **comments.lines**: number of program comment lines.
    -   **comments.inline**: number of program inline comments.
    -   **comments.block.count**: number of program block comments.
    -   **comments.block.length**: total character length of program block comments.
    -   **comments.block.whitespace**: amount of whitespace in program block comments.
    -   **comments.block.lines**: number of program block comment lines.
    -   **comments.block.inline**: number of program inline block comments.
    -   **comments.block.data.length**: character length of individual block comments.
    -   **comments.block.data.whitespace**: amount of whitespace in individual block comments.
    -   **comments.block.data.lines**: number of lines in individual block comments.
    -   **comments.line.count**: number of program line comments.
    -   **comments.line.length**: total character length of program line comments.
    -   **comments.line.whitespace**: amount of whitespace in program line comments.
    -   **comments.line.lines**: number of program line comment lines.
    -   **comments.line.inline**: number of program inline line comments.
    -   **comments.line.data.length**: character length of individual line comments.
    -   **comments.line.data.whitespace**: amount of whitespace in individual line comments.
    -   **comments.line.data.lines**: number of lines in individual line comments.
    -   **comments.jsdoc.count**: number of program JSDoc comments.
    -   **comments.jsdoc.length**: total character length of program JSDoc comments.
    -   **comments.jsdoc.whitespace**: amount of whitespace in program JSDoc comments.
    -   **comments.jsdoc.lines**: number of lines in program JSDoc comments.
    -   **comments.jsdoc.inline**: number of inline program JSDoc comments.
    -   **comments.jsdoc.data.length**: character length of individual JSDoc comments.
    -   **comments.jsdoc.data.whitespace**: amount of whitespace in individual JSDoc comments.
    -   **comments.jsdoc.data.lines**: number of lines in individual JSDoc comments.
    -   **dowhile.count**: number of `do...while` statements in a program.
    -   **dowhile.length**: character length of individual `do...while` statements.
    -   **dowhile.whitespace**: amount of whitespace in individual `do...while` statements.
    -   **dowhile.lines**: number of lines in individual `do...while` statements.
    -   **dowhile.empty**: number of empty lines in individual `do...while` statements.
    -   **dowhile.sloc**: source lines of code (SLOC) in individual `do...while` statements.
    -   **dowhile.lloc**: logical lines of code (LLOC) in individual `do...while` statements.
    -   **dowhile.scope**: function scope level for individual `do...while` statements.
    -   **dowhile.depth**: nesting depth for individual `do...while` statements.
    -   **dowhile.statements**: number of statements in individual `do...while` statements.
    -   **dowhile.branches**: number of branches in individual `do...while` statements.
    -   **dowhile.throw**: number of `throw` statements in individual `do...while` statements.
    -   **dowhile.literal.count**: number of literals in individual `do...while` statements.
    -   **expressions.array**: number of array expressions in a program.
    -   **expressions.assignment**: number of assignment expressions in a program.
    -   **expressions.binary**: number of binary expressions in a program.
    -   **expressions.call**: number of call expressions in a program.
    -   **expressions.conditional**: number of conditional expressions in a program.
    -   **expressions.function**: number of function expressions in a program.
    -   **expressions.logical**: number of logical expressions in a program.
    -   **expressions.member**: number of member expressions in a program.
    -   **expressions.new**: number of `new` expressions in a program.
    -   **expressions.object**: number of object expressions in a program.
    -   **expressions.sequence**: number of sequence expressions in a program.
    -   **expressions.this**: number of `this` expressions in a program.
    -   **expressions.unary**: number of unary expressions in a program.
    -   **expressions.update**: number of update expressions in a program.
    -   **expressions.yield**: number of `yield` expressions in a program.
    -   **for.count**: number of `for` statements in a program.
    -   **for.length**: character length of individual `for` statements.
    -   **for.whitespace**: amount of whitespace in individual `for` statements.
    -   **for.lines**: number of lines in individual `for` statements.
    -   **for.empty**: number of empty lines in individual `for` statements.
    -   **for.sloc**: source lines of code (SLOC) in individual `for` statements.
    -   **for.lloc**: logical lines of code (LLOC) in individual `for` statements.
    -   **for.scope**: function scope level for individual `for` statements.
    -   **for.depth**: nesting depth for individual `for` statements.
    -   **for.statements**: number of statements in individual `for` statements.
    -   **for.branches**: number of branches in individual `for` statements.
    -   **for.literal.count**: number of literals in individual `for` statements.
    -   **for.throw**: number of `throw` statements in individual `for` statements.
    -   **forin.count**: number of `for...in` statements in a program.
    -   **forin.length**: character length of individual `for...in` statements.
    -   **forin.whitespace**: amount of whitespace in individual `for...in` statements.
    -   **forin.lines**: number of lines in individual `for...in` statements.
    -   **forin.empty**: number of empty lines in individual `for...in` statements.
    -   **forin.sloc**: source lines of code (SLOC) in individual `for...in` statements.
    -   **forin.lloc**: logical lines of code (LLOC) in individual `for...in` statements.
    -   **forin.scope**: function scope level for individual `for...in` statements.
    -   **forin.depth**: nesting depth for individual `for...in` statements.
    -   **forin.statements**: number of statements in individual `for...in` statements.
    -   **forin.branches**: number of branches in individual `for...in` statements.
    -   **forin.literal.count**: number of literals in individual `for...in` statements.
    -   **forin.throw**: number of `throw` statements in individual `for...in` statements.
    -   **forof.count**: number of `for...of` statements in a program.
    -   **forof.length**: character length of individual `for...of` statements.
    -   **forof.whitespace**: amount of whitespace in individual `for...of` statements.
    -   **forof.lines**: number of lines in individual `for...of` statements.
    -   **forof.empty**: number of empty lines in individual `for...of` statements.
    -   **forof.sloc**: source lines of code (SLOC) in individual `for...of` statements.
    -   **forof.lloc**: logical lines of code (LLOC) in individual `for...of` statements.
    -   **forof.scope**: function level scope of individual `for...of` statements.
    -   **forof.depth**: nesting depth of individual `for...of` statements.
    -   **forof.statements**: number of statements in individual `for...of` statements.
    -   **forof.branches**: number of branches in individual `for...of` statements.
    -   **forof.literal.count**: number of literals in individual `for...of` statements.
    -   **forof.throw**: number of `throw` statements in individual `for...of` statements.
    -   **function.count**: number of functions in a program.
    -   **function.declaration**: number of functions which are function declarations.
    -   **function.expression**: number of functions which are function expressions.
    -   **function.length**: character length of individual functions.
    -   **function.whitespace**: amount of whitespace in individual functions.
    -   **function.lines**: number of lines in individual functions.
    -   **function.empty**: number of empty lines in individual functions.
    -   **function.sloc**: source lines of code (SLOC) in individual functions.
    -   **function.lloc**: logical lines of code (LLOC) in individual functions.
    -   **function.scope**: function scope of individual functions.
    -   **function.depth**: nesting depth of individual functions.
    -   **function.statements**: number of statements in individual functions.
    -   **function.branches**: number of branches in individual functions.
    -   **function.literal.count**: number of literals in individual functions.
    -   **function.throw**: number of `throw` statements in individual functions.
    -   **function.variable.count**: number of variable declarations in individual functions.
    -   **function.variable.nlength**: length of declared variables in individual functions.
    -   **function.nlength**: function name length for individual functions.
    -   **function.params**: number of function parameters for individual functions.
    -   **if.count**: number of `if` statements in a program.
    -   **if.length**: character length of individual `if` statements.
    -   **if.whitespace**: amount of whitespace in individual `if` statements.
    -   **if.lines**: number of lines in individual `if` statements.
    -   **if.empty**: number of empty lines in individual `if` statements.
    -   **if.sloc**: source lines of code (SLOC) in individual `if` statements.
    -   **if.lloc**: logical lines of code (LLOC) in individual `if` statements.
    -   **if.scope**: function scope level for individual `if` statements.
    -   **if.depth**: nesting depth of individual `if` statements.
    -   **if.statements**: number of statements in individual `if` statements.
    -   **if.branches**: number of branches in individual `if` statements.
    -   **if.literal.count**: number of literals in individual `if` statements.
    -   **if.throw**: number of `throw` statements in individual `if` statements.
    -   **literal.count**: number of literals in a program.
    -   **switch.count**: number of `switch` statements in a program.
    -   **switch.length**: character length of individual `switch` statements.
    -   **switch.whitespace**: amount of whitespace in individual `switch` statements.
    -   **switch.lines**: number of lines in individual `switch` statements.
    -   **switch.empty**: number of empty lines in individual `switch` statements.
    -   **switch.sloc**: source lines of code (SLOC) in individual `switch` statements.
    -   **switch.lloc**: logical lines of code (LLOC) in individual `switch` statements.
    -   **switch.scope**: function scope of individual `switch` statements.
    -   **switch.depth**: nesting depth of individual `switch` statements.
    -   **switch.statements**: number of statements in individual `switch` statements.
    -   **switch.branches**: number of branches in individual `switch` statements.
    -   **switch.literal.count**: number of literals in individual `switch` statements.
    -   **switch.throw**: number of `throw` statements in individual `switch` statements.
    -   **switch.case**: number of `case` clauses in individual `switch` statements.
    -   **throw**: number of `throw` statements in a program.
    -   **try.count**: number of `try` statements in a program.
    -   **try.length**: character length of individual `try` statements.
    -   **try.whitespace**: amount of whitespace in individual `try` statements.
    -   **try.lines**: number of lines in individual `try` statements.
    -   **try.empty**: number of empty lines in individual `try` statements.
    -   **try.sloc**: source lines of code (SLOC) in individual `try` statements.
    -   **try.lloc**: logical lines of code (LLOC) in individual `try` statements.
    -   **try.scope**: function scope of individual `try` statements.
    -   **try.depth**: nesting depth of individual `try` statements.
    -   **try.statements**: number of statements in individual `try` statements.
    -   **try.branches**: number of branches in individual `try` statements.
    -   **try.literal.count**: number of literals in individual `try` statements.
    -   **try.throw**: number of `throw` statements in individual `try` statements.
    -   **variable.count**: number of variables in a program.
    -   **variable.nlength**: length of variable names in a program.
    -   **while.count**: number of `while` statements in a program.
    -   **while.length**: character length of individual `while` statements.
    -   **while.whitespace**: amount of whitespace in individual `while` statements.
    -   **while.lines**: number of lines in individual `while` statements.
    -   **while.empty**: number of empty lines in individual `while` statements.
    -   **while.sloc**: source lines of code (SLOC) in individual `while` statements.
    -   **while.lloc**: logical lines of code (LLOC) in individual `while` statements.
    -   **while.scope**: function scope for individual `while` statements.
    -   **while.depth**: nesting depth of individual `while` statements.
    -   **while.statements**: number of statements in individual `while` statements.
    -   **while.branches**: number of branches in individual `while` statements.
    -   **while.literal.count**: number of literals in individual `while` statements.
    -   **while.throw**: number of `throw` statements in individual `while` statements.

-   Each metric is associated with a collection of summary statistics, as implemented by [`incrsummary`][@stdlib/stats/incr/summary].

-   The implementation uses code evaluation, which may be problematic in browser contexts enforcing a strict [content security policy][mdn-csp] (CSP).

</section>

<!-- /.notes -->

<!-- Package usage examples. -->

<section class="examples">

## Examples

<!-- eslint no-undef: "error" -->

```javascript
var incrsummary = require( '@stdlib/_tools/static-analysis/js/incr/program-summary' );

// Initialize an accumulator:
var acc = incrsummary();

// Analyze a series of programs:
var prog = 'var x = 5;\n';
acc( prog );

prog = 'var y = "beep";\n';
acc( prog );

prog = 'var z = {\n"foo": "bar"\n};\n';
acc( prog );

prog = 'function add( x, y ) {\n\treturn x + y;\n}\n';
acc( prog );

prog = 'for ( i = 0; i < 5; i++ ) {\n\tconsole.log( i );\n}\n';
acc( prog );

prog = 'if ( x < y ) {\n\tconsole.log( "x < y" );\n} else {\n\tconsole.log( "x >= y" );\n}\n';
acc( prog );

// Print the current state of the accumulator:
console.log( JSON.stringify( acc() ) );
```

</section>

<!-- /.examples -->

<!-- Section to include cited references. If references are included, add a horizontal rule *before* the section. Make sure to keep an empty line after the `section` element and another before the `/section` close. -->

<section class="references">

</section>

<!-- /.references -->

<!-- Section for related `stdlib` packages. Do not manually edit this section, as it is automatically populated. -->

<section class="related">

</section>

<!-- /.related -->

<!-- Section for all links. Make sure to keep an empty line after the `section` element and another before the `/section` close. -->

<section class="links">

[@stdlib/buffer/ctor]: https://github.com/stdlib-js/stdlib/tree/develop/lib/node_modules/%40stdlib/buffer/ctor

[@stdlib/_tools/static-analysis/js/program-summary]: https://github.com/stdlib-js/stdlib/tree/develop/lib/node_modules/%40stdlib/_tools/static-analysis/js/program-summary

[@stdlib/stats/incr/summary]: https://github.com/stdlib-js/stdlib/tree/develop/lib/node_modules/%40stdlib/stats/incr/summary

[mdn-csp]: https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP

</section>

<!-- /.links -->
