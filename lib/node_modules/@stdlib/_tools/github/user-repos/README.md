<!--

@license Apache-2.0

Copyright (c) 2021 The Stdlib Authors.

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

   http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.

-->

# User Repositories

> Get meta data for [repositories][github-repos] associated with a user.

<!-- Section to include introductory text. Make sure to keep an empty line after the intro `section` element and another before the `/section` close. -->

<section class="intro">

</section>

<!-- /.intro -->

<!-- Package usage documentation. -->

<section class="usage">

## Usage

```javascript
var repos = require( '@stdlib/_tools/github/user-repos' );
```

<a name="repos"></a>

#### repos( opts, clbk )

Gets meta data for [repositories][github-repos] associated with a user.

<!-- run-disable -->

```javascript
var opts = {
    'username': 'kgryte'
};

repos( opts, clbk );

function clbk( error, results, info ) {
    // Check for rate limit information...
    if ( info ) {
        console.error( 'Limit: %d', info.limit );
        console.error( 'Remaining: %d', info.remaining );
        console.error( 'Reset: %s', (new Date( info.reset*1000 )).toISOString() );
    }
    if ( error ) {
        throw new Error( error.message );
    }
    console.log( JSON.stringify( results ) );
    // => <repo_data>
}
```

The `function` accepts the following `options`:

-   **token**: GitHub [access token][github-token].
-   **username**: GitHub username.
-   **type**: repository [type][github-repos]. Can be one of `all`, `owner`, `member`,  `public`, or `private`. The `public` and `private` options are **only** applicable if the function is provided a `token` and no `username`.
-   **sort**: method used to sort meta data. Can be one of `full_name`, `created`, `pushed`, or `updated`.
-   **direction**: sort direction; either `asc` or `desc`.
-   **visibility**: repository visibility. Can be one of `all`, `public`, or `private`. Applicable if provided a `token` and no `username`. Ignored if `type` option is present.
-   **affiliation**: repository affiliation. A comma-separated list of values, which may include: `owner`, `collaborator`, `organization_member`. Applicable if provided a `token` and no `username`. Ignored if `type` option is present. 
-   **useragent**: [user agent][github-user-agent] `string`.

To [authenticate][github-oauth2] with GitHub, set the [`token`][github-token] option.

<!-- run-disable -->

```javascript
var opts = {
    'token': 'tkjorjk34ek3nj4!'
};

repos( opts, clbk );
```

To specify a [user agent][github-user-agent], set the `useragent` option.

<!-- run-disable -->

```javascript
var opts = {
    'username': 'kgryte',
    'useragent': 'hello-github!'
};

repos( opts, clbk );
```

To return repositories of a particular [type][github-repos], set the `type` option.

<!-- run-disable -->

```javascript
var opts = {
    'username': 'kgryte',
    'type': 'owner'
};

repos( opts, clbk );
```

To return repositories of a particular [visibility][github-repos], set the `visibility` option.

<!-- run-disable -->

```javascript
var opts = {
    'token': 'tkjorjk34ek3nj4!',
    'visibility': 'private'
};

repos( opts, clbk );
```

To return repositories of a particular [affiliation][github-repos], set the `affiliation` option.

<!-- run-disable -->

```javascript
var opts = {
    'token': 'tkjorjk34ek3nj4!',
    'affiliation': 'collaborator,organization_member'
};

repos( opts, clbk );
```

#### repos.factory( options, clbk )

Creates a reusable `function`.

<!-- run-disable -->

```javascript
var opts = {
    'username': 'kgryte',
    'token': 'tkjorjk34ek3nj4!'
};

var get = repos.factory( opts, clbk );

get();
get();
get();
// ...
```

The factory method accepts the same `options` as [`repos()`](#repos).

</section>

<!-- /.usage -->

<!-- Package usage notes. Make sure to keep an empty line after the `section` element and another before the `/section` close. -->

<section class="notes">

## Notes

-   Either a `username` or a [`token`][github-token] or both **must** be provided. If provided a [`token`][github-token], but not a `username`, the `function` [fetches][github-get] repositories associated with the authenticated user.

-   If not provided a `token`, the `function` can only return **public** repository meta data.

-   [Rate limit][github-rate-limit] information includes the following:
    -   **limit**: maximum number of requests a consumer is permitted to make per hour.
    -   **remaining**: number of remaining requests.
    -   **reset**: time at which the current [rate limit][github-rate-limit] window resets in [UTC seconds][unix-time].

</section>

<!-- /.notes -->

<!-- Package usage examples. -->

<section class="examples">

## Examples

```javascript
var repos = require( '@stdlib/_tools/github/user-repos' );

var opts = {
    'username': 'kgryte',
    'useragent': 'beep-boop-bop'
};

repos( opts, clbk );

function clbk( error, results, info ) {
    if ( info ) {
        console.error( info );
    }
    if ( error ) {
        throw new Error( error.message );
    }
    console.log( results );
}
```

</section>

<!-- /.examples -->

<!-- Section for describing a command-line interface. -->

* * *

<section class="cli">

## CLI

<!-- CLI usage documentation. -->

<section class="usage">

### Usage

```bash
Usage: ghuserrepos [options]

Options:

  -h,  --help                    Print this message.
  -V,  --version                 Print the package version.
       --token token             GitHub access token.
       --username username       GitHub username.
  -ua, --useragent ua            User agent.
       --visibility visibility   Repository visibility: public, private, all.
       --affiliation affiliation Repository affiliation.
       --type type               Repository type: forks, public, private, etc.
       --sort sort               Sort method: full_name, created, pushed, etc.
       --direction dir           Sort direction: asc, desc.
```

</section>

<!-- /.usage -->

<!-- CLI usage notes. Make sure to keep an empty line after the `section` element and another before the `/section` close. -->

<section class="notes">

### Notes

-   In addition to the [`token`][github-token] option, the [token][github-token] may also be specified by a [`GITHUB_TOKEN`][github-token] environment variable. The command-line option **always** takes precedence.
-   Request resources are written to `stdout`.
-   [Rate limit][github-rate-limit] information is written to `stderr`.

</section>

<!-- /.notes -->

<!-- CLI usage examples. -->

<section class="examples">

### Examples

Setting the access [token][github-token] using the command-line option:

<!-- run-disable -->

```bash
$ DEBUG=* ghuserrepos --token <token> --username kgryte
# => '[{...},{...},...]'
```

Setting the access [token][github-token] using an environment variable:

<!-- run-disable -->

```bash
$ DEBUG=* GITHUB_TOKEN=<token> ghuserrepos --username kgryte
# => '[{...},{...},...]'
```

</section>

<!-- /.examples -->

</section>

<!-- /.cli -->

<!-- Section to include cited references. If references are included, add a horizontal rule *before* the section. Make sure to keep an empty line after the `section` element and another before the `/section` close. -->

<section class="references">

</section>

<!-- /.references -->

<!-- Section for related `stdlib` packages. Do not manually edit this section, as it is automatically populated. -->

<section class="related">

</section>

<!-- /.related -->

<!-- Section for all links. Make sure to keep an empty line after the `section` element and another before the `/section` close. -->

<section class="links">

[unix-time]: https://en.wikipedia.org/wiki/Unix_time

[github-get]: https://github.com/kgryte/github-get

[github-repos]: https://developer.github.com/v3/repos/

[github-token]: https://github.com/settings/tokens/new

[github-oauth2]: https://developer.github.com/v3/#oauth2-token-sent-in-a-header

[github-user-agent]: https://developer.github.com/v3/#user-agent-required

[github-rate-limit]: https://developer.github.com/v3/rate_limit/

</section>

<!-- /.links -->
